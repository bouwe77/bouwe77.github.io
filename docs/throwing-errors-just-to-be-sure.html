<!DOCTYPE html>
<html lang="en">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta charset="UTF-8" />
    <title>Throwing errors, just to be sure</title>
    <meta name="description" content="bouwe.io, a blog by Bouwe Westerdijk" />
    <meta name="image" content="/bouwe-react-amsterdam.png" />
    <meta property="og:locale" content="en_US" />
    <meta property="og:site_name" content="bouwe.io" />
    <meta property="og:url" content="https://bouwe.io" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="bouwe.io" />
    <meta
      property="og:description"
      content="bouwe.io, a blog by Bouwe Westerdijk"
    />
    <meta
      property="og:image"
      content="https://bouwe.io/bouwe-react-amsterdam.png"
    />
    <meta property="og:image:alt" content="Bouwe Westerdijk" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:creator" content="@bouwe" />
    <meta name="twitter:url" content="https://bouwe.io" />
    <meta name="twitter:title" content="Throwing errors, just to be sure" />
    <meta
      name="twitter:description"
      content="bouwe.io, a blog by Bouwe Westerdijk"
    />
    <meta
      name="twitter:image"
      content="https://bouwe.io/bouwe-react-amsterdam"
    />
    <meta name="twitter:image:alt" content="Bouwe Westerdijk" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png" />
    <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png" />
    <link rel="manifest" href="/site.webmanifest" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5" />
    <meta name="msapplication-TileColor" content="#da532c" />
    <meta name="theme-color" content="#ffffff" />
    <link rel="stylesheet" href="/styles.css" />
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Open Sans"
    />
    <link
      rel="stylesheet"
      href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.3.1/build/styles/atom-one-dark-reasonable.min.css"
    />
    <script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.3.1/build/highlight.min.js"></script>
    <script>
      hljs.initHighlightingOnLoad();
    </script>
    <link
      href="/rss2.xml"
      type="application/rss+xml"
      rel="alternate"
      title="bouwe.io RSS Feed"
    />
    <link
      href="/atom.xml"
      type="application/atom+xml"
      rel="alternate"
      title="bouwe.io Atom feed"
    />
  </head>

  <body>
    <div>
      <header class="header">
        <div class="container">
          <div class="header-container">
            <div class="logo">
              <h1>
                <a href="/"
                  ><span class="logo-part1">bouwe</span
                  ><span class="logo-part2">.io</span></a
                >
              </h1>
            </div>
            <div class="nav"><ul class='nav-list'><li class='nav-item'><a href="/about" class='nav-inactive'>about</a></li><li class='nav-item'><a href="/blog" class='nav-inactive'>blog</a></li><li class='nav-item'><a href="/videos" class='nav-inactive'>videos</a></li><li class='nav-item'><a href="/contact" class='nav-inactive'>contact</a></li></ul></div>
          </div>
        </div>
      </header>
  
          <div class="main">
      <div class="container">
              <div>
        <h2 class="page-title">Throwing errors, just to be sure</h2>
      </div>

      <div><h3>Introduction</h3>
<p>Developers tend to throw errors in their code to notify themselves, their fellow developers, or their users, that they are doing something wrong.</p>
<p>Throwing errors is too rigorous, while instead, you could just solve the problem by making your code more meaningful, and of course, test your code.</p>
<blockquote>
<p>To be clear, I am talking about errors you throw in your own code, and not runtime errors that might occur because of calling someone else's code or API.</p>
</blockquote>
<h3>Let's take a walk</h3>
<p>A common example is a function that accepts arguments, and if you pass the wrong ones, it throws an error.</p>
<p>Suppose I am creating a 2D game and use the following <code>walk</code> function to determine the new <code>position</code> X and Y coordinate by supplying both the current <code>position</code>, and a <code>direction</code>:</p>
<pre><code class="language-js">function walk(position, direction) {
  if (direction === "west") return { ...position, x: position.x - 1 };
  if (direction === "east") return { ...position, x: position.x + 1 };
  if (direction === "north") return { ...position, y: position.y + 1 };
  if (direction === "south") return { ...position, y: position.y - 1 };

  throw new Error(`Unsupported direction: ${direction}`);
}
</code></pre>
<p>An example of calling this function:</p>
<pre><code class="language-js">let position = { x: 0, y: 0 };
position = walk(position, "east");
console.log(position); // { x: 1, y: 0}
</code></pre>
<p>This is a function written in JavaScript, uses immutability, and is meant to be pure: Given the same input it always returns the same output.</p>
<p>Notice an error is thrown when the direction is not one of the known directions. So for example, if I call the function as follows:</p>
<pre><code class="language-js">let position = { x: 0, y: 0 };
position = walk(position, "northeast");
// Error: Unsupported direction: northeast
</code></pre>
<p>Now my question is: Is it really necessary to throw an error when the direction is unexpected? The common answer is: "Yes, so we'll notice when someone uses a direction that is not supported!"</p>
<h3>Just do nothing</h3>
<p>You can teach a dog to sit when you say "Sit!". But what would it do when you say "Fly!"? Probably nothing. It would look at you and wait for you saying something it does understand. Until then, it probably does nothing.</p>
<p>Let's apply this to our code as well. So when the <code>direction</code> is not supported, the <code>walk</code> function should just do nothing. Well, except for just returning the current position again, because that's what the calling code expects:</p>
<pre><code class="language-js">function walk(position, direction) {
  if (direction === "west") return { ...position, x: position.x - 1 };
  if (direction === "east") return { ...position, x: position.x + 1 };
  if (direction === "north") return { ...position, y: position.y + 1 };
  if (direction === "south") return { ...position, y: position.y - 1 };

  // Here we just return the original, unchanged direction:
  return position;
}
</code></pre>
<p>And as a bonus, because it's a pure and immutable function, the calling code could even optimize what it will (or will not) do when it determines the position (reference) has not changed.</p>
<p>This is in my opinion much beter than handling a terrible error somewhere else in the code for something that is not terrible at all.</p>
<p>As soon as someone supplies a <code>direction</code> that is not supported, they will notice nothing happens. And then they will fix it.</p>
<h3>But we don't trust anyone!</h3>
<p>But what if the <code>direction</code> comes from outside of our code? From a user, or another app calling our code? Then we might want to let them know something is not right.</p>
<p>That's where input validation is for. So before you call the <code>walk</code> function, you validate the input. If the <code>direction</code> is not expected, let the user or caller know.</p>
<p>This way, the <code>walk</code> function will do what its name implies, just walk. If it can not walk in a specific direction, it is not called. So instead of throwing an error, you just prevent something unexpected to happen in the first place. It is important each function does only one thing and it does it well. This makes your code easy to reason about, maintainable, and testable.</p>
<p>This might mean the function becomes (too) dependent of another function that acts as a safeguard. An integration test which uses both functions together might make sense in that case.</p>
<p>It depends on your situation and preference whether you think this it's a good idea the function does not do its own validation too.</p>
<h3>Testing and type safety</h3>
<p>Testing and type safety are great tools to make sure your code does what it should do, both the happy and unhappy paths.</p>
<p>If we would have tests for the original <code>walk</code> function that threw the error, we'd also need a test the check if it throws an error for an unknown <code>direction</code>, right? With a dynamically typed language such as JavaScript this would be possible to test, although you are testing something that should not happen.</p>
<p>With a statically typed language such as TypeScript this would be unnecessary, because the <code>direction</code> argument can only have a valid value:</p>
<pre><code>type Direction = "west" | "east" | "north" | "south"

function walk(position: Position, direction: Direction) {
  if (direction === "west") return { ...position, x: position.x - 1 };
  if (direction === "east") return { ...position, x: position.x + 1 };
  if (direction === "north") return { ...position, y: position.y + 1 };
  if (direction === "south") return { ...position, y: position.y - 1 };
}
</code></pre>
<p>With tests and type safety, we only need to test what can and should happen. If later more directions are added, we add them to our type definitions and into our test suite.</p>
<p>This way, tests and types are almost like a manual of how to use our code, just look at them, and you know how it works. No errors, because they will only make it less clear and make you wonder why it is in there: When and why can it go wrong, giving you a suspicious feeling.</p>
<h3>Errors to control the flow of your code</h3>
<p>Another very common reason for throwing errors is using it as a way to control the flow of your code, for example to exit early, while it actually indicates your code is not structured well.</p>
<pre><code>// example of an API request handler that validates the input, queries the DB, and throws
// errors for everything that is not a happy flow, so 400 Bad Request, 404 Not Found, etc.
</code></pre>
<p>Instead of using errors as an escape hatch, let's just fix it. All of the situations where the code is throwing errors are functional situations you know will happen, so why not just return early?</p>
<pre><code>// example...
</code></pre>
<h3>When to throw errors</h3>
<p>Whether or not you agree with me throwing errors is not always necessary, there are, however, situations where throwing errors might be necessary.</p>
<p>Check out the following function that divides the given numbers:</p>
<pre><code class="language-js">function divide(a, b) {
  return a / b;
}
</code></pre>
<p>Let's call that function:</p>
<pre><code class="language-js">divide(1, 1); // returns 1
divide(10, 2); // returns 5
divide(2, 0); // returns Infinity...
</code></pre>
<p>Division by zero is probably not very useful, so if you would follow my proposal to then just "do nothing", what would the correct return value be? There is none! In other words, this is a case for either throwing an error, or making sure (and testing that) it is not called when the second argument is 0.</p>
<p>However, this is an exception. In many other cases, there is nothing wrong with just doing nothing. You will notice, and fix it, when that is not what you want. Throwing errors is only for situations that are really unexpected, exceptions to the rule, from which you can not recover, or can not respond to in a useful way.</p>
<h3>Conclusion</h3>
<p>My point is: Don't just throw errors all over the place. First think: Is this really a bad situation that I need to know of, and can't prevent? Errors should indicate something bad has happened, so by throwing a lot of errors you give the impression to other developers a lot of bad and dangerous things can and will happen. But is that really the case?</p>
<p>Which other things can I do gain more trust in my code? Perhaps a good test suite is already sufficient?</p>
<p>I think it depends on the situation whether throwing errors is really necessary, but that it is almost always not necessary at all.</p>
</div>

            <div>
        <a
          href="https://twitter.com/intent/tweet?text=Throwing errors, just to be sure&url=https://bouwe.io/throwing-errors-just-to-be-sure&via=bouwe"
          >Share on Twitter</a
        >
        ·
        <a href="https://twitter.com/search?q=https://bouwe.io/throwing-errors-just-to-be-sure"
          >Discuss on Twitter</a
        >
        ·
        <a href="https://github.com/bouwe77/bouwe.io/edit/master/content/pages/throwing-errors-just-to-be-sure.md">Edit on GitHub</a>
      </div>

      </div>
    </div>

    <footer></footer>
  

    </div>

  </body>
</html>
